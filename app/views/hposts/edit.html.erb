<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
</head>

<div class="parent">
    <div class="child">
        <header>
            <h1>Make Your </h1>
        </header>

        <div class="input_form row" id="in_here">
            
            <div class="form-group">
                <label class="sr-only" for="pic">pic</label>
                <%= simple_form_for @hpost,remote:true, html: {multipart: true} do |f| %>
                    <div class="field">
                        <%= f.input :picture, as: :file %>
                        <%= f.hidden_field :picture_cache %>
                    </div>
                <%= f.hidden_field :htmltag ,value:"",id:"htmltag" %>
                    <br>
                    <div class="actions">
                        <%= f.submit id:"submit_poster" %>
                    </div>
                    <a href="/hposts/<%=@hpost.id%>">완 료</a>
                <% end %>
            </div>
        </div>
    </div>
    
  <!-- 오른쪽 poster -->
  <!--여기에 디비에 있는 html tag를 넣을꺼임-->
  <div class="child" id="here"></div>

</div>


<script>
    //일단 html 태그 넣으시고요~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
     var tag = "<%=escape_javascript(@hpost.htmltag)%>";
    
     $("#here").html(tag.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,"\""));
    
    //그다음은 이미지 넣으시고요~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
    
    $('#pt_picture_input').attr('src','<%=@hpost.picture.url%>');
    
    //그다음 html 태그 로부터 텍스트 컨텐츠가 몇개 있는지 확인 하시고요~~~~~~~~~~~~~
    
    var text_contents_count = $("#here .text_content").length;
    
    //그 갯수만큼 반복문 돌려서 왼쪽에 인풋태그 넣으시고요
    
    for(var i=0;i<text_contents_count;i++){
    //이벤트 연결을 인덱스로해야하나 아니면 그냥 .... 클래스명으로해야하나 ..하.
          $("#in_here").prepend("<div class=\"form-group\"><input type=\"text\" class=\"form-control text_input\" id=\"content1\"></div>");
        
    }
    
    //일단 키업이벤트를 인덱스로 받아온다면???
    <%for ind in 0..3%>
        $(".text_input:eq(<%=ind%>)").keyup(function(){
            $('.text_content:eq(<%=ind%>)').empty();
            $('.text_content:eq(<%=ind%>)').append("div"+$(".text_input:eq(<%=ind%>)").val()+"</div>");
        });
    <%end%>
    
    
    
    
    
// <!-- 실시간으로 input 값이 입력 되는 script -->
    //   $('#content1').keyup(function (){
    //     $('#pt_content1' , "div" ).empty();
    //     $('#pt_content1').append("<div>"+document.getElementById("content1").value+"</div>");
    //   });
      
    //   $('#content2').keyup(function (){
    //     $('#pt_content2' , "div" ).empty();
    //     $('#pt_content2').append("<div>"+document.getElementById("content2").value+"</div>");
    //   });
      
    //   $('#content3').keyup(function (){
    //     $('#pt_content3' , "div" ).empty();
    //     $('#pt_content3').append("<div>"+document.getElementById("content3").value+"</div>");
    //   });
      $("body").mousedown(function(){    
        $("#htmltag").val($("#here").html())
      });
      
  
    $("#hpost_picture").change(function(){
      $('#submit_poster').trigger('click');
    });

</script>